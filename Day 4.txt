All patients who have gone through admissions, can see their medical documents on our site. Those patients are given a temporary password after their first admission. Show the patient_id and temp_password.

The password must be the following, in order:
1. patient_id
2. the numerical length of patient's last_name
3. year of patient's birth_date

--select distinct p.patient_id, concat(p.patient_id, len(p.last_name), year(p.birth_date))
from patients p inner join admissions ad on p.patient_id = ad.patient_id;

Show the provinces that has more patients identified as 'M' than 'F'. Must only show full province_name

select  pn.province_name
from 
patients p join province_names pn on p.province_id=pn.province_id 
group by pn.province_name 
having 
sum (case when p.gender='M' then 1 else 0 end) >
sum (Case when p.gender='F' then 1 else 0 end)
;

We are looking for a specific patient. Pull all columns for the patient who matches the following criteria:
- First_name contains an 'r' after the first two letters.
- Identifies their gender as 'F'
- Born in February, May, or December
- Their weight would be between 60kg and 80kg
- Their patient_id is an odd number
- They are from the city 'Kingston'

select * from patients where first_name like '__r%' and month (birth_date) in (2,5,12)
and weight between 60 and 80
and patient_id%2!=0
and city='Kingston';
;






Need to try later:
1. Each admission costs $50 for patients without insurance, and $10 for patients with insurance. All patients with an even patient_id have insurance.

Give each patient a 'Yes' if they have insurance, and a 'No' if they don't have insurance. Add up the admission_total cost for each has_insurance group.


select 

COUNT (has_insurance)
case 
when patient_id%2=0 Then "yes"
when patient_id%2!=0 then "no"
end as has_insurance

from  admissions group by has_insurance;